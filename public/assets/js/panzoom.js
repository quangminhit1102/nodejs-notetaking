let transformX,transformY,transformScale;!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;(t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).panzoom=e()}}(function(){return(function(){function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!c&&u)return u(a,!0);if(i)return i(a,!0);var f=Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var s=n[a]={exports:{}};t[a][0].call(s.exports,function(e){return r(t[a][1][e]||e)},s,s.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}return e})()({1:[function(e,t,n){"use strict";var o=e("wheel"),r=e("amator"),i=e("ngraph.events"),a=e("./lib/kinetic.js"),c=e("./lib/createTextSelectionInterceptor.js"),u=c(),f=c(!0),s=e("./lib/transform.js"),l=e("./lib/svgController.js"),$=e("./lib/domController.js");function m(e,t){var n,c,m,d,x,g,_,b,w,C,S,E=(t=t||{}).controller;if(!E&&(l.canAttach(e)?E=l(e,t):$.canAttach(e)&&(E=$(e,t))),!E)throw Error("Cannot create panzoom for the current type of dom element");var k=E.getOwner(),T={x:0,y:0},L=!1,F=new s;E.initTransform&&E.initTransform(F);var A="function"==typeof t.filterKey?t.filterKey:v,B="number"==typeof t.pinchSpeed?t.pinchSpeed:1,z=t.bounds,j="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,M="number"==typeof t.minZoom?t.minZoom:0,O="number"==typeof t.boundsPadding?t.boundsPadding:.05,Z="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:1.75,D=t.beforeWheel||v,q=t.beforeMouseDown||v,I="number"==typeof t.zoomSpeed?t.zoomSpeed:1,N=p(t.transformOrigin),P=t.enableTextSelection?f:u;(function e(t){var n=typeof t;if("undefined"!==n&&"boolean"!==n&&!(h(t.left)&&h(t.top)&&h(t.bottom)&&h(t.right)))throw Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")})(z),t.autocenter&&function e(){var t,n,o=0,r=0,i=em();if(i)o=i.left,r=i.top,t=i.right-i.left,n=i.bottom-i.top;else{var a=k.getBoundingClientRect();t=a.width,n=a.height}var c=E.getBBox();if(0!==c.width&&0!==c.height){var u=n/c.height,f=Math.min(t/c.width,u);F.x=-(c.left+c.width/2)*f+t/2+o,F.y=-(c.top+c.height/2)*f+n/2+r,F.scale=f}}();var R=0,Y=0,X=0,V=null,W=new Date,G=!1,K=!1;b="smoothScroll"in t&&!t.smoothScroll?{start:v,stop:v,cancel:v}:a(function e(){return{x:F.x,y:F.y}},function e(t,n){e2(),es(t,n)},t.smoothScroll);var U=!1;ey();var H={dispose:function e(){ex()},moveBy:eh,moveTo:es,smoothMoveTo:function e(t,n){eh(t-F.x,n-F.y,!0)},centerOn:function e(t){var n=t.ownerSVGElement;if(!n)throw Error("ui element is required to be within the scene");var o,r=t.getBoundingClientRect(),i=r.left+r.width/2,a=r.top+r.height/2,c=n.getBoundingClientRect();eh(c.width/2-i,c.height/2-a,!0)},zoomTo:eO,zoomAbs:ev,smoothZoom:eM,smoothZoomAbs:function e(t,n,o){var i=F.scale;b.cancel(),e2(),C=r({scale:i},{scale:o},{step:function(e){ev(t,n,e.scale)}})},showRectangle:function e(t){var n=k.getBoundingClientRect(),o=en(n.width,n.height),r=t.right-t.left,i=t.bottom-t.top;if(!Number.isFinite(r)||!Number.isFinite(i))throw Error("Invalid rectangle");var a,c=Math.min(o.x/r,o.y/i);F.x=-(t.left+r/2)*c+o.x/2,F.y=-(t.top+i/2)*c+o.y/2,F.scale=c},pause:function e(){ex(),U=!0},resume:function e(){U&&(ey(),U=!1)},isPaused:et,getTransform:eo,getMinZoom:er,setMinZoom:ei,getMaxZoom:ea,setMaxZoom:ec,getTransformOrigin:eu,setTransformOrigin:function e(t){N=p(t)},getZoomSpeed:ef,setZoomSpeed:function e(t){if(!Number.isFinite(t))throw Error("Zoom speed should be a number");I=t}};i(H);var J="number"==typeof t.initialX?t.initialX:F.x,Q="number"==typeof t.initialY?t.initialY:F.y,ee="number"==typeof t.initialZoom?t.initialZoom:F.scale;return(J!=F.x||Q!=F.y||ee!=F.scale)&&ev(J,Q,ee),H;function et(){return U}function en(e,t){if(E.getScreenCTM){var n=E.getScreenCTM(),o=n.a,r=n.d,i=n.e,a=n.f;T.x=e*o-i,T.y=t*r-a}else T.x=e,T.y=t;return T}function eo(){return F}function er(){return M}function ei(e){M=e}function ea(){return j}function ec(e){j=e}function eu(){return N}function ef(){return I}function es(e,t){F.x=e,F.y=t,e$(),eN("pan"),ep()}function el(e,t){es(F.x+e,F.y+t)}function e$(){var e=em();if(e){var t,n,o,r,i=!1,a=(o=E.getBBox(),r=(t=o.left,n=o.top,{x:t*F.scale+F.x,y:n*F.scale+F.y}),{left:r.x,top:r.y,right:o.width*F.scale+r.x,bottom:o.height*F.scale+r.y}),c=e.left-a.right;return c>0&&(F.x+=c,i=!0),(c=e.right-a.left)<0&&(F.x+=c,i=!0),(c=e.top-a.bottom)>0&&(F.y+=c,i=!0),(c=e.bottom-a.top)<0&&(F.y+=c,i=!0),i}}function em(){if(z){if("boolean"==typeof z){var e=k.getBoundingClientRect(),t=e.width,n=e.height;return{left:t*O,top:n*O,right:t*(1-O),bottom:n*(1-O)}}return z}}function ep(){L=!0,n=window.requestAnimationFrame(eg)}function ed(e,t,n){if(y(e)||y(t)||y(n))throw Error("zoom requires valid numbers");var o=F.scale*n;if(o<M){if(F.scale===M)return;n=M/F.scale}if(o>j){if(F.scale===j)return;n=j/F.scale}var r=en(e,t);(F.x=r.x-n*(r.x-F.x),F.y=r.y-n*(r.y-F.y),z&&1===O&&1===M)?(F.scale*=n,e$()):e$()||(F.scale*=n),eN("zoom"),ep()}function ev(e,t,n){ed(e,t,n/F.scale)}function eh(e,t,n){if(!n)return el(e,t);w&&w.cancel();var o=0,i=0;w=r({x:0,y:0},{x:e,y:t},{step:function(e){el(e.x-o,e.y-i),o=e.x,i=e.y}})}function ey(){k.addEventListener("mousedown",eL,{passive:!1}),k.addEventListener("dblclick",eT,{passive:!1}),k.addEventListener("touchstart",eb,{passive:!1}),k.addEventListener("keydown",e_,{passive:!1}),o.addWheelListener(k,e3,{passive:!1}),ep()}function ex(){o.removeWheelListener(k,e3),k.removeEventListener("mousedown",eL),k.removeEventListener("keydown",e_),k.removeEventListener("dblclick",eT),k.removeEventListener("touchstart",eb),n&&(window.cancelAnimationFrame(n),n=0),b.cancel(),eB(),ez(),P.release(),eq()}function eg(){L&&(L=!1,E.applyTransform(F),eN("transform"),n=0)}function e_(e){var t=0,n=0,o=0;if(38===e.keyCode?n=1:40===e.keyCode?n=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?o=1:(187===e.keyCode||107===e.keyCode)&&(o=-1),!A(e,t,n,o)){if(t||n){e.preventDefault(),e.stopPropagation();var r,i=k.getBoundingClientRect(),a=Math.min(i.width,i.height);eh(.05*a*t,.05*a*n)}if(o){var c,u=eZ(100*o),a=N?e1():(c=k.getBoundingClientRect(),{x:c.width/2,y:c.height/2});eO(a.x,a.y,u)}}}function eb(e){var n,o,r,i,a,u,f,s;n=e,(!t.onTouch||t.onTouch(n))&&(n.stopPropagation(),n.preventDefault()),eC(),2===e.touches.length&&(o=e,Y=new Date,r=o.touches[0],i=o.touches[1],a=ej(r),u=ej(i),c=f={x:(a.x+u.x)/2,y:(a.y+u.y)/2},m=(s=en(f.x,f.y)).x,d=s.y,x=m,g=d,b.cancel(),ew(),_=ek(e.touches[0],e.touches[1]),S=!0,ew())}function ew(){!G&&(G=!0,document.addEventListener("touchmove",e0),document.addEventListener("touchend",eE),document.addEventListener("touchcancel",eE))}function e0(e){if(2===e.touches.length){S=!0;var t=e.touches[0],n=e.touches[1],o=ej(t),r=ej(n),i={x:(o.x+r.x)/2,y:(o.y+r.y)/2},a=en(i.x,i.y),c=a.x-m,u=a.y-d;0!==c&&0!==u&&eD(),m=i.x,d=i.y,eh(c,u);var f=ek(t,n),s=1+(f/_-1)*B;if(N){var i=e1();m=i.x,d=i.y}eO(m,d,s),_=f,e.stopPropagation()}}function eC(){X&&(clearTimeout(X),X=0)}function eS(e){if(t.onClick){eC();var n=m-x,o=d-g;Math.sqrt(n*n+o*o)>5||(X=setTimeout(function(){X=0,t.onClick(e)},300))}}function eE(e){if(eC(),e.touches.length>0){var t=ej(e.touches[0]),n=en(t.x,t.y);m=n.x,d=n.y}else{var o=new Date;if(o-R<300){if(N){var t=e1();eM(t.x,t.y,Z)}else eM(c.x,c.y,Z)}else o-Y<200&&eS(e);R=o,eq(),ez()}}function ek(e,t){var n=e.clientX-t.clientX,o=e.clientY-t.clientY;return Math.sqrt(n*n+o*o)}function eT(e){n=e,eC(),(!t.onDoubleClick||t.onDoubleClick(n))&&(n.preventDefault(),n.stopPropagation());var n,o=ej(e);N&&(o=e1()),eM(o.x,o.y,Z)}function eL(e){if(eC(),!q(e)){if(V=e,W=new Date,G)return e.stopPropagation(),!1;if(!((1!==e.button||null===window.event)&&0!==e.button)){b.cancel();var t=ej(e),n=en(t.x,t.y);return x=m=n.x,g=d=n.y,document.addEventListener("mousemove",eF),document.addEventListener("mouseup",eA),P.capture(e.target||e.srcElement),!1}}}function eF(e){if(!G){eD();var t=ej(e),n=en(t.x,t.y),o=n.x-m,r=n.y-d;m=n.x,d=n.y,eh(o,r)}}function eA(){new Date-W<200&&eS(V),P.release(),eq(),eB()}function eB(){document.removeEventListener("mousemove",eF),document.removeEventListener("mouseup",eA),K=!1}function ez(){document.removeEventListener("touchmove",e0),document.removeEventListener("touchend",eE),document.removeEventListener("touchcancel",eE),K=!1,S=!1,G=!1}function e3(e){if(!D(e)){b.cancel();var t=e.deltaY;e.deltaMode>0&&(t*=100);var n=eZ(t);if(1!==n){var o=N?e1():ej(e);eO(o.x,o.y,n),e.preventDefault()}}}function ej(e){var t,n,o=k.getBoundingClientRect();return{x:t=e.clientX-o.left,y:n=e.clientY-o.top}}function eM(e,t,n){var o=F.scale;b.cancel(),e2(),C=r({scale:o},{scale:n*o},{step:function(n){ev(e,t,n.scale)},done:eI})}function e1(){var e=k.getBoundingClientRect();return{x:e.width*N.x,y:e.height*N.y}}function eO(e,t,n){return b.cancel(),e2(),ed(e,t,n)}function e2(){C&&(C.cancel(),C=null)}function eZ(e){return 1-Math.sign(e)*Math.min(.25,Math.abs(I*e/128))}function eD(){K||(eN("panstart"),K=!0,b.start())}function eq(){K&&(S||b.stop(),eN("panend"))}function eI(){eN("zoomend")}function eN(e){H.fire(e,H)}}function p(e){if(e){if("object"==typeof e)return h(e.x)&&h(e.y)||d(e),e;d()}}function d(e){throw console.error(e),Error('Cannot parse transform origin.\nSome good examples:\n  "center center" can be achieved with {x: 0.5, y: 0.5}\n  "top center" can be achieved with {x: 0.5, y: 0}\n  "bottom right" can be achieved with {x: 1, y: 1}')}function v(){}function h(e){return Number.isFinite(e)}function y(e){return Number.isNaN?Number.isNaN(e):e!=e}t.exports=m,!function e(){if("undefined"!=typeof document){var t,n=document.getElementsByTagName("script");if(n){for(var o=0;o<n.length;++o){var r=n[o];if(r.src&&r.src.match(/\bpanzoom(\.min)?\.js/)){t=r;break}}if(t){var i=t.getAttribute("query");if(i){var a=t.getAttribute("name")||"pz",c=Date.now();!function e(){var n,o=document.querySelector(i);if(!o){if(Date.now()-c<2e3){setTimeout(e,100);return}console.error("Cannot find the panzoom element",a);return}var r=function e(t){for(var n=t.attributes,o={},r=0;r<n.length;++r){var i=u(n[r]);i&&(o[i.name]=i.value)}return o}(t);console.log(r),window[a]=m(o,r)}()}}}}function u(e){if(e.name&&"p"===e.name[0]&&"z"===e.name[1]&&"-"===e.name[2]){var t;return{name:e.name.substr(3),value:JSON.parse(e.value)}}}}()},{"./lib/createTextSelectionInterceptor.js":2,"./lib/domController.js":3,"./lib/kinetic.js":4,"./lib/svgController.js":5,"./lib/transform.js":6,amator:7,"ngraph.events":9,wheel:10}],2:[function(e,t,n){function o(e){return e.stopPropagation(),!1}function r(){}t.exports=function e(t){if(t)return{capture:r,release:r};var n,i,a,c=!1;return{capture:function e(t){c=!0,i=window.document.onselectstart,a=window.document.ondragstart,window.document.onselectstart=o,(n=t).ondragstart=o},release:function e(){c&&(c=!1,window.document.onselectstart=i,n&&(n.ondragstart=a))}}}},{}],3:[function(e,t,n){t.exports=function e(t,n){if(!o(t))throw Error("panzoom requires DOM element to be attached to the DOM tree");var r=t.parentElement;return t.scrollTop=0,n.disableKeyboardInteraction||r.setAttribute("tabindex",0),{getBBox:function e(){return{left:0,top:0,width:t.clientWidth,height:t.clientHeight}},getOwner:i,applyTransform:function e(n){t.style.transformOrigin="0 0 0",t.style.transform="matrix("+n.scale.toFixed(4)+", 0, 0, "+n.scale.toFixed(4)+", "+n.x.toFixed(4)+", "+n.y.toFixed(4)+")"}};function i(){return r}},t.exports.canAttach=o;function o(e){return e&&e.parentElement&&e.style}},{}],4:[function(e,t,n){t.exports=function e(t,n,o){"object"!=typeof o&&(o={});var r,i,a,c,u,f,s,l,$,m,p="number"==typeof o.minVelocity?o.minVelocity:5,d="number"==typeof o.amplitude?o.amplitude:.25,v="function"==typeof o.cancelAnimationFrame?o.cancelAnimationFrame:"function"==typeof cancelAnimationFrame?cancelAnimationFrame:clearTimeout,h="function"==typeof o.requestAnimationFrame?o.requestAnimationFrame:"function"==typeof requestAnimationFrame?requestAnimationFrame:function(e){return setTimeout(e,16)};return{start:function e(){r=t(),f=$=c=s=0,i=new Date,v(a),v(m),a=h(y)},stop:function e(){v(a),v(m);var n=t();u=n.x,l=n.y,i=Date.now(),(c<-p||c>p)&&(u+=f=d*c),(s<-p||s>p)&&(l+=$=d*s),m=h(x)},cancel:function e(){v(a),v(m)}};function y(){var e=Date.now(),n=e-i;i=e;var o=t(),u=o.x-r.x,f=o.y-r.y;r=o;var l=1e3/(1+n);c=.8*u*l+.2*c,s=.8*f*l+.2*s,a=h(y)}function x(){var e=Date.now()-i,t=!1,o=0,r=0;f&&((o=-f*Math.exp(-e/342))>.5||o<-.5?t=!0:o=f=0),$&&((r=-$*Math.exp(-e/342))>.5||r<-.5?t=!0:r=$=0),t&&(n(u+o,l+r),m=h(x))}}},{}],5:[function(e,t,n){t.exports=function e(t,n){if(!o(t))throw Error("svg element is required for svg.panzoom to work");var r=t.ownerSVGElement;if(!r)throw Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");return n.disableKeyboardInteraction||r.setAttribute("tabindex",0),{getBBox:function e(){var n=t.getBBox();return{left:n.x,top:n.y,width:n.width,height:n.height}},getScreenCTM:function e(){var t=r.getCTM();return t||r.getScreenCTM()},getOwner:i,applyTransform:function e(n){transformX=n.x.toFixed(4),transformY=n.y.toFixed(4),transformScale=n.scale.toFixed(4),t.style.transform=`matrix(${transformScale}, 0, 0, ${transformScale}, ${transformX}, ${transformY})`},initTransform:function e(n){var o=t.getCTM();null===o&&(o=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),n.x=o.e,n.y=o.f,n.scale=o.a,r.removeAttributeNS(null,"viewBox")}};function i(){return r}},t.exports.canAttach=o;function o(e){return e&&e.ownerSVGElement&&e.getCTM}},{}],6:[function(e,t,n){t.exports=function e(){this.x=0,this.y=0,this.scale=1}},{}],7:[function(e,t,n){var o=e("bezier-easing"),r={ease:o(.25,.1,.25,1),easeIn:o(.42,0,1,1),easeOut:o(0,0,.58,1),easeInOut:o(.42,0,.58,1),linear:o(0,0,1,1)};function i(){}function a(){var e=new Set,t=new Set,n=0;return{next:o,cancel:o,clearAll:function o(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}};function o(e){t.add(e),n||(n=requestAnimationFrame(r))}function r(){n=0;var o=t;t=e,(e=o).forEach(function(e){e()}),e.clear()}function i(e){t.delete(e)}}t.exports=function e(t,n,o){var a,c=Object.create(null),u=Object.create(null),f="function"==typeof(o=o||{}).easing?o.easing:r[o.easing];f||(o.easing&&console.warn("Unknown easing function in amator: "+o.easing),f=r.ease);var s="function"==typeof o.step?o.step:i,l="function"==typeof o.done?o.done:i,$=function e(t){if(!t)return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}};if("function"!=typeof t.next)throw Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof t.cancel)throw Error("Scheduler is supposed to have cancel(handle) function");return t}(o.scheduler),m=Object.keys(n);m.forEach(function(e){c[e]=t[e],u[e]=n[e]-t[e]});var p=Math.max(1,.06*("number"==typeof o.duration?o.duration:400)),d=0;return a=$.next(v),{cancel:function e(){$.cancel(a),a=0}};function v(){var e,n=f(d/p);d+=1,e=n,m.forEach(function(n){t[n]=u[n]*e+c[n]}),d<=p?(a=$.next(v),s(t)):(a=0,setTimeout(function(){l(t)},0))}},t.exports.makeAggregateRaf=a,t.exports.sharedScheduler=a()},{"bezier-easing":8}],8:[function(e,t,n){var o="function"==typeof Float32Array;function r(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function a(e){return 3*e}function c(e,t,n){var o;return((r(t,n)*e+i(t,n))*e+3*(o=t))*e}function u(e,t,n){var o;return 3*r(t,n)*e*e+2*i(t,n)*e+3*(o=t)}function f(e){return e}t.exports=function e(t,n,r,i){if(!(0<=t&&t<=1&&0<=r&&r<=1))throw Error("bezier x values must be in [0, 1] range");if(t===n&&r===i)return f;for(var a=o?new Float32Array(11):Array(11),s=0;s<11;++s)a[s]=c(.1*s,t,r);return function e(o){return 0===o?0:1===o?1:c(function e(n){for(var o=0,i=1;10!==i&&a[i]<=n;++i)o+=.1;var f=o+(n-a[--i])/(a[i+1]-a[i])*.1,s=u(f,t,r);return s>=.001?function e(t,n,o,r){for(var i=0;i<4;++i){var a=u(n,o,r);if(0===a)break;var f=c(n,o,r)-t;n-=f/a}return n}(n,f,t,r):0===s?f:function e(t,n,o,r,i){var a,u,f=0;do(a=c(u=n+(o-n)/2,r,i)-t)>0?o=u:n=u;while(Math.abs(a)>1e-7&&++f<10);return u}(n,o,o+.1,t,r)}(o),n,i)}}},{}],9:[function(e,t,n){t.exports=function e(t){!function e(t){if(!t)throw Error("Eventify cannot use falsy object as events subject");for(var n=["on","fire","off"],o=0;o<n.length;++o)if(t.hasOwnProperty(n[o]))throw Error("Subject cannot be eventified, since it already has property '"+n[o]+"'")}(t);var n,o,r=(n=t,o=Object.create(null),{on:function(e,t,r){if("function"!=typeof t)throw Error("callback is expected to be a function");var i=o[e];return i||(i=o[e]=[]),i.push({callback:t,ctx:r}),n},off:function(e,t){if(void 0===e)return o=Object.create(null),n;if(o[e]){if("function"!=typeof t)delete o[e];else for(var r=o[e],i=0;i<r.length;++i)r[i].callback===t&&r.splice(i,1)}return n},fire:function(e){var t,r=o[e];if(!r)return n;arguments.length>1&&(t=Array.prototype.splice.call(arguments,1));for(var i=0;i<r.length;++i){var a=r[i];a.callback.apply(a.ctx,t)}return n}});return t.on=r.on,t.off=r.off,t.fire=r.fire,t}},{}],10:[function(e,t,n){function o(e,t,n){e.addEventListener("wheel",t,n)}t.exports=o,t.exports.addWheelListener=o,t.exports.removeWheelListener=function e(t,n,o){t.removeEventListener("wheel",n,o)}},{}]},{},[1])(1)});